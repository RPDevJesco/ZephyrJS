<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>XRadioGroup Example</title>
    <script type="module">
        if (location.hostname.endsWith('github.io')) {
            await import('../core/GHPagesModules.js');
        } else {
            await import('../core/XModules.js');
        }
    </script>
    <style>
        :root {
            --x-accent: #4f46e5;
            --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial;
        }
        body {
            font-family: var(--font);
            margin: 24px;
            max-width: 900px;
        }
        .form-group {
            margin-bottom: 16px;
        }
        .row {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-top: 16px;
            flex-wrap: wrap;
        }
        #output {
            background: #f8fafc;
            padding: 12px;
            border-radius: 6px;
            margin-top: 16px;
            font-family: monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        .demo-section {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
        }
        .demo-section h3 {
            margin-top: 0;
            color: #374151;
        }
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
        .layout-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .layout-demo > div {
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 16px;
        }
        .layout-demo h4 {
            margin-top: 0;
            margin-bottom: 12px;
            color: #6b7280;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
    </style>
</head>
<body>
<h1>XRadioGroup Examples</h1>

<div class="demo-section">
    <h3>Customer Survey Form</h3>
    <form id="survey-form">
        <div class="form-grid">
            <x-input
                    id="customer-name"
                    label="Customer Name"
                    type="text"
                    placeholder="Enter your name"
                    required
                    value="">
            </x-input>

            <x-select
                    id="product-category"
                    label="Product Category"
                    placeholder="Select category"
                    required
                    options='[
            {"value":"software","label":"Software"},
            {"value":"hardware","label":"Hardware"},
            {"value":"service","label":"Service"},
            {"value":"support","label":"Support"}
          ]'
                    value="">
            </x-select>
        </div>

        <div class="form-group">
            <x-radio-group
                    id="satisfaction"
                    label="Overall Satisfaction"
                    name="satisfaction"
                    required
                    layout="horizontal"
                    options='[
            {"value":"very-satisfied","label":"😍 Very Satisfied"},
            {"value":"satisfied","label":"😊 Satisfied"},
            {"value":"neutral","label":"😐 Neutral"},
            {"value":"dissatisfied","label":"😕 Dissatisfied"},
            {"value":"very-dissatisfied","label":"😤 Very Dissatisfied"}
          ]'
                    value="">
            </x-radio-group>
        </div>

        <div class="form-group">
            <x-radio-group
                    id="recommendation"
                    label="Would you recommend us to others?"
                    name="recommendation"
                    required
                    options='[
            {"value":"definitely","label":"Definitely! I love your product"},
            {"value":"probably","label":"Probably, it meets my needs"},
            {"value":"maybe","label":"Maybe, it depends on the situation"},
            {"value":"probably-not","label":"Probably not, I have some concerns"},
            {"value":"definitely-not","label":"Definitely not, I had a bad experience"}
          ]'
                    value="">
            </x-radio-group>
        </div>

        <div class="form-group">
            <x-radio-group
                    id="contact-preference"
                    label="Preferred Contact Method"
                    name="contact_preference"
                    layout="grid"
                    options='[
            {"value":"email","label":"📧 Email"},
            {"value":"phone","label":"📞 Phone"},
            {"value":"sms","label":"📱 SMS"},
            {"value":"chat","label":"💬 Live Chat"},
            {"value":"none","label":"🚫 Do not contact"}
          ]'
                    value="">
            </x-radio-group>
        </div>

        <div class="form-group">
            <x-textarea
                    id="additional-comments"
                    label="Additional Comments"
                    placeholder="Tell us more about your experience..."
                    auto-resize
                    show-count
                    max-length="500"
                    rows="3"
                    value="">
            </x-textarea>
        </div>

        <div class="row">
            <x-button id="submit-survey-btn" label="Submit Survey" variant="primary"></x-button>
            <x-button id="reset-survey-btn" label="Reset Form"></x-button>
        </div>
    </form>
</div>

<div class="demo-section">
    <h3>Layout Demonstrations</h3>

    <div class="layout-demo">
        <div>
            <h4>Vertical Layout (Default)</h4>
            <x-radio-group
                    id="vertical-demo"
                    label="Choose an option"
                    name="vertical_demo"
                    layout="vertical"
                    options='[
            {"value":"option1","label":"First Option"},
            {"value":"option2","label":"Second Option"},
            {"value":"option3","label":"Third Option"}
          ]'
                    value="">
            </x-radio-group>
        </div>

        <div>
            <h4>Horizontal Layout</h4>
            <x-radio-group
                    id="horizontal-demo"
                    label="Select priority"
                    name="horizontal_demo"
                    layout="horizontal"
                    options='[
            {"value":"high","label":"High"},
            {"value":"medium","label":"Medium"},
            {"value":"low","label":"Low"}
          ]'
                    value="medium">
            </x-radio-group>
        </div>

        <div>
            <h4>Grid Layout</h4>
            <x-radio-group
                    id="grid-demo"
                    label="Choose features"
                    name="grid_demo"
                    layout="grid"
                    options='[
            {"value":"basic","label":"Basic Plan"},
            {"value":"premium","label":"Premium Plan"},
            {"value":"enterprise","label":"Enterprise Plan"},
            {"value":"custom","label":"Custom Solution"}
          ]'
                    value="">
            </x-radio-group>
        </div>

        <div>
            <h4>Disabled State</h4>
            <x-radio-group
                    id="disabled-demo"
                    label="Unavailable options"
                    name="disabled_demo"
                    disabled
                    options='[
            {"value":"option1","label":"Option 1"},
            {"value":"option2","label":"Option 2"},
            {"value":"option3","label":"Option 3"}
          ]'
                    value="option2">
            </x-radio-group>
        </div>
    </div>
</div>

<div class="demo-section">
    <h3>Dynamic Options Management</h3>

    <div class="form-group">
        <x-radio-group
                id="dynamic-radio"
                label="Dynamic Radio Group"
                name="dynamic"
                options='[]'
                value="">
        </x-radio-group>
    </div>

    <div class="form-grid">
        <x-input
                id="option-value"
                label="Option Value"
                placeholder="e.g., option1"
                value="">
        </x-input>

        <x-input
                id="option-label"
                label="Option Label"
                placeholder="e.g., First Option"
                value="">
        </x-input>
    </div>

    <div class="row">
        <x-button id="add-option-btn" label="Add Option" variant="primary"></x-button>
        <x-button id="clear-options-btn" label="Clear All"></x-button>
        <x-button id="load-colors-btn" label="Load Colors"></x-button>
        <x-button id="load-sizes-btn" label="Load Sizes"></x-button>
    </div>
</div>

<div class="demo-section">
    <h3>Settings Configuration</h3>

    <div class="form-group">
        <x-radio-group
                id="theme-setting"
                label="Application Theme"
                name="theme"
                layout="horizontal"
                options='[
          {"value":"light","label":"☀️ Light"},
          {"value":"dark","label":"🌙 Dark"},
          {"value":"auto","label":"🔄 Auto"}
        ]'
                value="auto">
        </x-radio-group>
    </div>

    <div class="form-group">
        <x-radio-group
                id="notification-setting"
                label="Notification Frequency"
                name="notifications"
                options='[
          {"value":"realtime","label":"Real-time (immediate notifications)"},
          {"value":"hourly","label":"Hourly (digest every hour)"},
          {"value":"daily","label":"Daily (digest once per day)"},
          {"value":"weekly","label":"Weekly (digest once per week)"},
          {"value":"never","label":"Never (disable all notifications)"}
        ]'
                value="daily">
        </x-radio-group>
    </div>

    <div class="row">
        <x-button id="save-settings-btn" label="Save Settings" variant="primary"></x-button>
        <x-button id="reset-settings-btn" label="Reset to Defaults"></x-button>
    </div>
</div>

<div class="demo-section">
    <h3>Programmatic Control Demo</h3>

    <div class="form-group">
        <x-radio-group
                id="control-demo"
                label="Test Radio Group"
                name="control_test"
                options='[
          {"value":"red","label":"🔴 Red"},
          {"value":"green","label":"🟢 Green"},
          {"value":"blue","label":"🔵 Blue"}
        ]'
                value="">
        </x-radio-group>
    </div>

    <div class="row">
        <x-button id="select-red-btn" label="Select Red"></x-button>
        <x-button id="select-green-btn" label="Select Green"></x-button>
        <x-button id="select-blue-btn" label="Select Blue"></x-button>
        <x-button id="clear-selection-btn" label="Clear Selection"></x-button>
        <x-button id="set-error-btn" label="Set Error"></x-button>
        <x-button id="clear-error-btn" label="Clear Error"></x-button>
    </div>
</div>

<div id="output">
    <strong>Form State (DOM attributes):</strong><br>
    <div id="state-data"></div>
</div>

<script type="module">
    class RadioGroupDemoController {
        constructor() {
            this.radioGroups = document.querySelectorAll('x-radio-group');
            this.inputs = document.querySelectorAll('x-input');
            this.selects = document.querySelectorAll('x-select');
            this.textareas = document.querySelectorAll('x-textarea');
            this.stateOutput = document.getElementById('state-data');

            this.bindEvents();
            this.updateStateDisplay();
        }

        bindEvents() {
            // Listen to all form element changes
            const allElements = [
                ...this.radioGroups,
                ...this.inputs,
                ...this.selects,
                ...this.textareas
            ];

            allElements.forEach(element => {
                const eventMap = {
                    'x-radio-group': 'radio-change',
                    'x-input': 'input-change',
                    'x-select': 'select-change',
                    'x-textarea': 'textarea-change'
                };

                const eventType = eventMap[element.tagName.toLowerCase()];

                element.addEventListener(eventType, (e) => {
                    console.log(`${element.id} changed:`, e.detail);
                    this.updateStateDisplay();
                });
            });

            // Survey form controls
            document.getElementById('submit-survey-btn').addEventListener('button-click', () => {
                this.handleSurveySubmit();
            });

            document.getElementById('reset-survey-btn').addEventListener('button-click', () => {
                this.handleSurveyReset();
            });

            // Dynamic options controls
            document.getElementById('add-option-btn').addEventListener('button-click', () => {
                this.addDynamicOption();
            });

            document.getElementById('clear-options-btn').addEventListener('button-click', () => {
                this.clearDynamicOptions();
            });

            document.getElementById('load-colors-btn').addEventListener('button-click', () => {
                this.loadColorOptions();
            });

            document.getElementById('load-sizes-btn').addEventListener('button-click', () => {
                this.loadSizeOptions();
            });

            // Settings controls
            document.getElementById('save-settings-btn').addEventListener('button-click', () => {
                this.saveSettings();
            });

            document.getElementById('reset-settings-btn').addEventListener('button-click', () => {
                this.resetSettings();
            });

            // Programmatic controls
            document.getElementById('select-red-btn').addEventListener('button-click', () => {
                document.getElementById('control-demo').selectOption('red');
            });

            document.getElementById('select-green-btn').addEventListener('button-click', () => {
                document.getElementById('control-demo').selectOption('green');
            });

            document.getElementById('select-blue-btn').addEventListener('button-click', () => {
                document.getElementById('control-demo').selectOption('blue');
            });

            document.getElementById('clear-selection-btn').addEventListener('button-click', () => {
                document.getElementById('control-demo').clearSelection();
            });

            document.getElementById('set-error-btn').addEventListener('button-click', () => {
                document.getElementById('control-demo').setAttr('error', 'This is a custom error message');
            });

            document.getElementById('clear-error-btn').addEventListener('button-click', () => {
                document.getElementById('control-demo').removeAttribute('error');
            });
        }

        handleSurveySubmit() {
            // Trigger validation on required fields
            const requiredFields = [
                'customer-name', 'product-category', 'satisfaction', 'recommendation'
            ];

            requiredFields.forEach(id => {
                document.getElementById(id).dispatchEvent(new Event('blur'));
            });

            // Check for errors
            const hasErrors = requiredFields.some(id =>
                document.getElementById(id).hasAttribute('error')
            );

            if (hasErrors) {
                alert('Please fix validation errors before submitting');
                return;
            }

            // Collect survey data
            const surveyData = {
                customer: {
                    name: document.getElementById('customer-name').getAttribute('value'),
                    productCategory: document.getElementById('product-category').getAttribute('value')
                },
                ratings: {
                    satisfaction: document.getElementById('satisfaction').getAttribute('value'),
                    recommendation: document.getElementById('recommendation').getAttribute('value'),
                    contactPreference: document.getElementById('contact-preference').getAttribute('value')
                },
                feedback: {
                    comments: document.getElementById('additional-comments').getAttribute('value')
                },
                selectedOptions: {
                    satisfaction: document.getElementById('satisfaction').getSelectedOption(),
                    recommendation: document.getElementById('recommendation').getSelectedOption(),
                    contactPreference: document.getElementById('contact-preference').getSelectedOption()
                }
            };

            console.log('Survey submitted:', surveyData);
            alert('Thank you for your feedback! Check console for details.');
        }

        handleSurveyReset() {
            const surveyFields = [
                'customer-name', 'product-category', 'satisfaction',
                'recommendation', 'contact-preference', 'additional-comments'
            ];

            surveyFields.forEach(id => {
                const element = document.getElementById(id);
                element.setAttr('value', '');
                element.removeAttribute('error');
            });
        }

        addDynamicOption() {
            const valueInput = document.getElementById('option-value');
            const labelInput = document.getElementById('option-label');
            const radioGroup = document.getElementById('dynamic-radio');

            const value = valueInput.getAttribute('value')?.trim();
            const label = labelInput.getAttribute('value')?.trim();

            if (!value) {
                alert('Please enter an option value');
                return;
            }

            radioGroup.addOption(value, label || value);

            // Clear inputs
            valueInput.setAttr('value', '');
            labelInput.setAttr('value', '');
        }

        clearDynamicOptions() {
            document.getElementById('dynamic-radio').clearOptions();
        }

        loadColorOptions() {
            const radioGroup = document.getElementById('dynamic-radio');
            const colorOptions = [
                { value: 'red', label: '🔴 Red' },
                { value: 'orange', label: '🟠 Orange' },
                { value: 'yellow', label: '🟡 Yellow' },
                { value: 'green', label: '🟢 Green' },
                { value: 'blue', label: '🔵 Blue' },
                { value: 'purple', label: '🟣 Purple' }
            ];

            radioGroup.setAttr('options', JSON.stringify(colorOptions));
            radioGroup.setAttr('layout', 'grid');
        }

        loadSizeOptions() {
            const radioGroup = document.getElementById('dynamic-radio');
            const sizeOptions = [
                { value: 'xs', label: 'Extra Small (XS)' },
                { value: 's', label: 'Small (S)' },
                { value: 'm', label: 'Medium (M)' },
                { value: 'l', label: 'Large (L)' },
                { value: 'xl', label: 'Extra Large (XL)' },
                { value: 'xxl', label: '2X Large (XXL)' }
            ];

            radioGroup.setAttr('options', JSON.stringify(sizeOptions));
            radioGroup.setAttr('layout', 'horizontal');
        }

        saveSettings() {
            const settings = {
                theme: document.getElementById('theme-setting').getAttribute('value'),
                notifications: document.getElementById('notification-setting').getAttribute('value')
            };

            // Simulate saving to localStorage or API
            console.log('Settings saved:', settings);
            alert(`Settings saved!\nTheme: ${settings.theme}\nNotifications: ${settings.notifications}`);
        }

        resetSettings() {
            document.getElementById('theme-setting').setAttr('value', 'auto');
            document.getElementById('notification-setting').setAttr('value', 'daily');
        }

        updateStateDisplay() {
            const state = {
                radioGroups: {},
                inputs: {},
                selects: {},
                textareas: {}
            };

            // Collect radio group states
            this.radioGroups.forEach(radioGroup => {
                const value = radioGroup.getAttribute('value') || '';
                state.radioGroups[radioGroup.id] = {
                    value: value,
                    selectedOption: radioGroup.getSelectedOption(),
                    options: radioGroup.getAttribute('options') || '[]',
                    layout: radioGroup.getAttribute('layout') || 'vertical',
                    error: radioGroup.getAttribute('error') || null,
                    disabled: radioGroup.hasAttribute('disabled'),
                    required: radioGroup.hasAttribute('required')
                };
            });

            // Collect other form element states (abbreviated for space)
            this.inputs.forEach(input => {
                state.inputs[input.id] = {
                    value: input.getAttribute('value') || '',
                    error: input.getAttribute('error') || null
                };
            });

            this.selects.forEach(select => {
                state.selects[select.id] = {
                    value: select.getAttribute('value') || '',
                    error: select.getAttribute('error') || null
                };
            });

            this.textareas.forEach(textarea => {
                const value = textarea.getAttribute('value') || '';
                state.textareas[textarea.id] = {
                    value: value,
                    valueLength: value.length,
                    error: textarea.getAttribute('error') || null
                };
            });

            this.stateOutput.innerHTML = '<pre>' + JSON.stringify(state, null, 2) + '</pre>';
        }
    }

    // Initialize the demo controller
    new RadioGroupDemoController();

    // Demo: Auto-select some options after load
    setTimeout(() => {
        console.log('Demo: Auto-selecting medium priority');
        document.getElementById('horizontal-demo').selectOption('medium');
    }, 2000);

    // Demo: Show validation error
    setTimeout(() => {
        console.log('Demo: Setting validation error on satisfaction rating');
        document.getElementById('satisfaction').setAttr('error', 'Please rate your satisfaction to continue');
    }, 4000);

    // Clear demo error
    setTimeout(() => {
        console.log('Demo: Clearing validation error');
        document.getElementById('satisfaction').removeAttribute('error');
    }, 7000);
</script>
</body>
</html>